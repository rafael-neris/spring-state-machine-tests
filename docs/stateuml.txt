@startuml
[*] --> NEW : PRE_AUTHORIZE
NEW --> PRE_AUTH : PRE_AUTH_APPROVED
NEW --> PRE_AUTH_ERROR : PRE_AUTH_DECLINED
PRE_AUTH_ERROR --> [*]
PRE_AUTH --> AUTHORIZED : AUTHORIZED
AUTHORIZED --> [*]
PRE_AUTH --> AUTHORIZE_ERROR : AUTH_DECLINED
AUTHORIZE_ERROR --> [*]
AUTHORIZE_ERROR --> Refund : REFUND

state Refund {
  [*] --> REFUND
  REFUND --> RESERVED : RESERVE
  RESERVED --> CONFIRMED : CONFIRM
  CONFIRMED --> REFUND_COMPLETED : REFUND_COMPLETED
  REFUND_COMPLETED --> [*]
}
@enduml